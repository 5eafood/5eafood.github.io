<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>what happen | SeaFood&#39;s blog</title>
  <meta name="author" content="SeaFood">
  
  <meta name="description" content="�����Ƿ���googleʱ��������ʲô��΢���Ͽ��������������⣬�������������������� www.google.com ���Ұ��»س�֮��������ʲô��������дһ���Լ������⣨�����������ص����ݣ���">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="what happen"/>
  <meta property="og:site_name" content="SeaFood&#39;s blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="SeaFood&#39;s blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">SeaFood&#39;s blog</a></h1>
  <h2><a href="/">es muss sein? es muss sein!</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-03-30T17:15:49.000Z"><a href="/2017/03/31/what-happen/">2017-03-31</a></time>
      
      
  
    <h1 class="title">what happen</h1>
  

    </header>
    <div class="entry">
      
        <h1 id="�����Ƿ���googleʱ��������ʲo"><a href="#�����Ƿ���googleʱ��������ʲo" class="headerlink" title="�����Ƿ���googleʱ��������ʲô"></a>�����Ƿ���googleʱ��������ʲô</h1><p>��΢���Ͽ��������������⣬�������������������� www.google.com ���Ұ��»س�֮��������ʲô��������дһ���Լ������⣨�����������ص����ݣ���<br><a id="more"></a></p>
<h2 id="url����"><a href="#url����" class="headerlink" title="url����"></a>url����</h2><p>������ͨ����������url���ж�URL�Ƿ��Ϸ������ڷǷ�URL�ִ��������Ὣ֮���ݸ��������档��������������������������punycode���롣</p>
<h2 id="��������"><a href="#��������" class="headerlink" title="��������"></a>��������</h2><p>�����������յ���url�г�ȡ�������ֶΣ����Ƿ��ʵ�������</p>
<ol>
<li>���������������ȼ����Լ��������Ƿ�����������Ӧ��ip��������������������һ��</li>
<li>����hosts�ļ����Ƿ���������Ӧ��IP�����������ڽ�����һ��</li>
<li>һЩ·����Ҳ�Ỻ��������Ϣ��·�����������м��飬��������Ϊ�ͻ��˵�dns����</li>
<li>�ն��򱾵�DNS���������������󣬱���DNSͨ���������ṩ�̣��������ţ��ṩ�����������ֹ��趨Ϊ���ƹȸ��ṩ��8.8.8.8����DNS������dns��Ϊ������Ȩ������������������Ϣ��DNS����ͨ��ΪUDP��ʽ�����ڳ��ȹ���ʱ������TCP��ʽ</li>
<li>����DNS���������������Ƿ����ڶ�Ӧ��������Ϣ���������ڣ�����13̨��������������������������������������Ϊ<strong>www.google.com</strong>������<strong>com</strong>��������������������֮�󽫻��õ�<strong>google.com</strong>���������������ĵ�ַ</li>
<li>����DNS������<strong>google.com</strong>�������������������������󣬲����ջ�����<strong>www.google.com</strong>��IP��ַ��Ϣ</li>
<li>����DNS����ѯ���õ�IP��ַ��Ϣ���沢���ظ��ͻ��� </li>
</ol>
<h3 id="�����ٳ�"><a href="#�����ٳ�" class="headerlink" title="�����ٳ�"></a>�����ٳ�</h3><ol>
<li>����·�������ı���DNS��ʹ��ָ���ڿ͵�DNS�����������ش�����ip���Խٳ�����</li>
<li>ֱ������DNS���������޸Ļ���</li>
<li>����dns����Ϊudp���ص㣬����ʵDNS���󷵻�ǰ�����ܺ��߷���һ��α����DNS������Ӧ</li>
</ol>
<h3 id="dns-rebinding-����"><a href="#dns-rebinding-����" class="headerlink" title="dns rebinding ����"></a>dns rebinding ����</h3><p>����DNS�������Ļ�������ʱ�ޣ���TTL(Time- To-Live)<br>��������Ҫ�����ܺ�����<strong>www.b.com/secret.php</strong> �µ�����            </p>
<ol>
<li>�����������ǵ�����ttlΪ1����(���̵�ʱ��)</li>
<li>�յ��ܺ��߷���<strong>www.a.com/evil.html</strong>���������ȴ�1��������</li>
<li>֮�������ǽ�<strong>www.a.com</strong>�󶨵�<strong>www.b.com</strong>��ip��</li>
<li>����js��ttlʱ������ʹ�ܺ��߷��� <strong>www.a.com/secret.php</strong>��ʵ����js���ʵ�ʹ<strong>www.b.com/secret.php</strong>,ʹ��js����ҳ������<br>�������������÷�ʽ��������������©���ƹ�ip����</li>
</ol>
<h2 id="TLS����"><a href="#TLS����" class="headerlink" title="TLS����"></a>TLS����</h2><p>TLS��Ϊ��HTTPS��ʹ�ã�������ÿ����վ����Ҫ��Ŀǰgoogle��ȫ��ʹ��HTTPS      </p>
<ol>
<li>�ͻ��˷���һ��<strong>Client hello</strong>��Ϣ���������ˣ���Ϣ��ͬʱ����������TLS�汾�� �������Ϳ��õ�ѹ���㷨</li>
<li>�����������ͻ��˷���һ<strong>Server hello</strong>��Ϣ����Ϣ�а����˷������˵�TLS�汾��������ѡ�����ĸ����ܺ�ѹ���㷨���Լ��������Ĺ���֤�飬֤���а����˹�Կ���ͻ��˻�ʹ��������Կ���ܽ����������ֹ��̣�ֱ��Э������һ���µĶԳ���Կ</li>
<li>�ͻ��˸����Լ�������CA�б�����֤�������˵�֤���Ƿ���Ч��������Ч���ͻ��˻�����һ��α��������ʹ�÷������Ĺ�Կ���������⴮�������ᱻ���������µĶԳ���Կ</li>
<li>��������ʹ���Լ���˽Կ���������ᵽ����������Ȼ��ʹ���⴮�����������Լ��ĶԳ�����Կ</li>
<li>�ͻ��˷���һ��<strong>Finished</strong>��Ϣ���������ˣ�ʹ�öԳ���Կ��������ͨѶ��һ��ɢ��ֵ</li>
<li>�������������Լ��� hash ֵ��Ȼ�����ܿͻ��˷���������Ϣ������������ֵ�Ƿ���Ӧ��������Ӧ�������ͻ��˷���һ��<strong>Finished</strong>��Ϣ��Ҳʹ��Э�̺õĶԳ���Կ����</li>
<li>�����ڿ�ʼ������������ TLS �Ự��ʹ�öԳ���Կ���м��ܣ�����Ӧ�ò㣨HTTP������</li>
</ol>
<h3 id="�м��˽ٳ�"><a href="#�м��˽ٳ�" class="headerlink" title="�м��˽ٳ�"></a>�м��˽ٳ�</h3><p>https�޷�ֱ�ӱ��м��˹�������������վû��ǿ���û�ʹ��HTTPS���ڿͿ�������<strong>SSLStrip</strong>�������м��˹�����httpsת��Ϊhttp���Ӷ��ٳֳɹ���ͬ���ķ��������������ĵ�DNS�ٳ�һͬʹ�ã���Ϊ������������TLS���֡�</p>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>http����tcp/ipЭ�飬���������ĵ�������ip�Ͷ˿ں�������������һ�������˿�������������tcp����������</p>
<h3 id="TCP��������"><a href="#TCP��������" class="headerlink" title="TCP��������"></a>TCP��������</h3><p>TCP�п���λ��6����־���ع��ɣ�����SYN���������������ӣ�ACK����ȷ�����к���Ч��</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1. client�����������󣬿���λ�е�ACK=0��SYN=1�������㷨����SYN���ݶε����к�seq=x����������SYN_SENT״̬�ȴ�server��Ӧ</div><div class="line">2. server�����յ���������������ͬ�����ӣ�����client����ȷ�ϣ�ACK=1��SYN=1���㷨����SYN���ݶε����к�seq=y��ACK��ȷ�����к�Ϊack=x+1��server����SYN_RECV״̬</div><div class="line">3. client��SYN=0,ACK=1,seq=x+1,ack=y+1�����͸�server���������߶�����ESTABLISHED״̬������TCP�������֡�</div><div class="line">4. serverÿ����һ������seq=seq+1��client����ack=seq+1(��������ͷ��û��keep-alive��������һ�����ݺ����ӶϿ�)</div><div class="line">5. �������ر�TCP���ӣ�����һ��FIN��clientȷ��FIN������һ��ACKΪ�յ����к�+1�������Լ���FIN�����ر����ݴ��ͣ�server����ACKΪ�յ����к�+1��֮�󳹵׹ر�</div></pre></td></tr></table></figure>
<p>��TCP���ֵĵڶ�������ȱ�ݣ������߿��Է��ʹ���SYN�������������ķ�������Դ����SYN Flood������Ϊ�˽����������⣬��Ҫ����SYN cookie��</p>
<p>���յ�SYN�����󣬷����������仺������ʹ��IP��������Ϣ����cookie����Ϊ���кŷ��ظ�client���ͻ��˷���ack���������¼���cookie���뷵��ֵȷ�Ϻ��ٷ�����Դ��</p>
<p>tcp���ӽ��������������������������ģ����а�����http��Э���汾�������ķ�����host��user-agent�����뷽ʽ��ѹ����ʽ�ȡ�������������֧�ֹȸ���SPDYЭ�飬������HTTP��ͷ������ѹ�����Լ������Ż����ӿ������ٶȡ�</p>
<p>����������http�����󣬽��յķ�����Ӧ��Ϊ����������������������������ת���������ķ�������������Ӧ�������ظ���������</p>
<p>�������յ���Ӧ����ǰ�˻�������Ⱦ������js��css�ļ������˶�ǰ���˽ⲻ�࣬�Ͳ���д�ˡ�</p>
<h2 id="���紫������"><a href="#���紫������" class="headerlink" title="���紫������"></a>���紫������</h2><ol>
<li>��˫����ͬһ��������Ҫ����������Ҫ�Է���MAC��ַ����ʱ������Ҫ<code>ARP��Address Resolution Protocol��</code>��arp���������ṩIP��MAC��ַ��ӳ����ϵ����������������һ���ȼ���������arp�����Ƿ��ж�Ӧ��ӳ����ϵ���������ڣ��򷢳�ARP�㲥��������ӦIP��������Ӧ����Ӧ�����յ�ARP�㲥�󣬷�������MAC��ַ��֮������ͨ�š���Ȼ���κ�����������ӦARP�㲥������������ӦARP�㲥�����ش�����MAC��ַ�����ɽ���ARP��ƭ������</li>
<li>��˫������ͬһ�������������ط����������ڴ�֮ǰҪ�����ص�MAC���������ϡ�·�ɻ�һ��һ����Ѱ��ͨ�Ŷ�����֮�󷵻�һ�����̵�·����</li>
<li>ͨ��������Ӫ�̻�ʹ��<code>NAT(Network Address Translation)</code>���������û�����������������ʱ����IP���з������û�һ������IP�Ͷ˿�����ͨ�š�</li>
</ol>

      
    </div>
    <footer>
      
        
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">Comments</h1>

  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  

  
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 SeaFood
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




</body>
</html>
